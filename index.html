<div id="spinPage" style="display:none;" class="card">
    <h4>ЁЯОб Lucky Spin</h4>
    <div id="wheelContainer" style="font-size: 50px; transition: transform 3s ease-out; margin: 20px 0;">ЁЯОб</div>
    <p id="spinResult">ржЪрж╛ржХрж╛ржЯрж┐ ржШрзБрж░рж┐рзЯрзЗ ржнрж╛ржЧрзНржп ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи!</p>
    <button class="btn" style="background:#f1c40f; color:#2c3e50;" onclick="startSpin()" id="spinBtn">ЁЯМА Spin Now</button>
</div>

<script>
    let isSpinning = false;

    async function startSpin() {
        if(isSpinning) return;
        isSpinning = true;
        
        let wheel = document.getElementById('wheelContainer');
        let btn = document.getElementById('spinBtn');
        btn.disabled = true;
        
        // ржПржирж┐ржорзЗрж╢ржи
        wheel.style.transform = "rotate(1800deg)";
        
        let res = await fetch(`${BASE}/spin`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({user_id: user.id})
        });
        let data = await res.json();
        
        setTimeout(() => {
            wheel.style.transform = "rotate(0deg)";
            tg.showAlert(`ржЕржнрж┐ржиржирзНржжржи! ржЖржкржирж┐ ${data.win} ржкрзЯрзЗржирзНржЯ ржЬрж┐рждрзЗржЫрзЗржиред`);
            document.getElementById('spinResult').innerText = `ржЖржкржирж┐ рж╢рзЗрж╖ржмрж╛рж░ ${data.win} ржкрзЯрзЗржирзНржЯ ржкрзЗрзЯрзЗржЫрзЗржи!`;
            isSpinning = false;
            btn.disabled = false;
            load(); // ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЖржкржбрзЗржЯ
        }, 3000);
    }
    
    // ржирзНржпрж╛ржнрж┐ржЧрзЗрж╢ржирзЗ рж╕рзНржкрж┐ржи ржмрж╛ржЯржи ржпрзЛржЧ ржХрж░рзБржи
    function showSpin() { showTab('spinPage'); }
</script>
