<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarnQuick Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script src="https://hathomeynapoleon.com/1b/df/db/1bdfdbcd7aca5ef4e2890826a8c56e14.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='10070523' data-sdk='show_10070523'></script>

    <style>
        :root { --bg: #0b0e14; --card: #161b22; --accent: #00d2ff; --text: #ffffff; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; text-align: center; }
        .welcome { position: fixed; inset: 0; background: #000; z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .header { padding: 40px 20px; background: linear-gradient(135deg, #00d2ff, #3a7bd5); border-radius: 0 0 30px 30px; }
        .user-img { width: 70px; height: 70px; border-radius: 50%; border: 3px solid #fff; }
        .stats { display: flex; gap: 10px; padding: 20px; margin-top: -30px; }
        .stat-box { flex: 1; background: var(--card); padding: 15px; border-radius: 15px; border: 1px solid #333; }
        .stat-box b { font-size: 20px; color: var(--accent); }
        .nav-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .btn { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #444; color: #fff; text-decoration: none; cursor: pointer; }
        .btn i { font-size: 25px; color: var(--accent); margin-bottom: 10px; display: block; }
        .btn:active { transform: scale(0.95); }
        .footer { font-size: 11px; color: #666; padding: 20px; }
    </style>
</head>
<body>

<div id="welcome" class="welcome">
    <h2>হ্যালো, <span id="w_name">ইউজার</span>!</h2>
    <p>EarnQuick-এ আপনাকে স্বাগতম</p>
    <button onclick="startApp()" style="padding: 12px 30px; border-radius: 10px; border: none; background: var(--accent); font-weight: bold;">শুরু করুন</button>
</div>

<div id="main" style="display:none">
    <div class="header">
        <img id="u_img" class="user-img" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
        <h3 id="u_name">Najmul Hoque Forhad</h3>
    </div>

    <div class="stats">
        <div class="stat-box">পয়েন্ট<br><b id="bal">0</b></div>
        <div class="stat-box">রেফার<br><b id="ref">0</b></div>
    </div>

    <div class="nav-grid">
        <div class="btn" onclick="watchAd()">
            <i class="fas fa-play-circle"></i>অ্যাড দেখুন (+৫)
        </div>
        <div class="btn" onclick="copyRef()">
            <i class="fas fa-user-plus"></i>রেফার (+২০০)
        </div>
        <div class="btn" onclick="tg.showAlert('মিনিমাম ৪০০০ পয়েন্ট লাগবে')">
            <i class="fas fa-wallet"></i>উইথড্র
        </div>
        <div class="btn" onclick="location.reload()">
            <i class="fas fa-sync"></i>রিফ্রেশ
        </div>
    </div>

    <div class="footer">
        Owner: Najmul Hoque Forhad<br>
        01913621510 | najmulh112233@gmail.com
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    const user = tg.initDataUnsafe.user;
    const URL = "https://earnquick-backend.onrender.com";

    document.getElementById('w_name').innerText = user.first_name;
    document.getElementById('u_name').innerText = user.first_name;
    if(user.photo_url) document.getElementById('u_img').src = user.photo_url;

    function startApp() {
        document.getElementById('welcome').style.display = 'none';
        document.getElementById('main').style.display = 'block';
    }

    async function load() {
        try {
            const r = await fetch(`${URL}/data?user_id=${user.id}`);
            const d = await r.json();
            document.getElementById('bal').innerText = d.balance;
            document.getElementById('ref').innerText = d.refs;
        } catch(e) {}
    }

    function watchAd() {
        if (typeof show_10070523 === 'function') {
            show_10070523().then(async () => {
                // সরাসরি ব্যাক-এন্ডে পয়েন্ট যোগ করার রিকোয়েস্ট
                await fetch(`${URL}/add_point`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: user.id, point: 5})
                });
                tg.showPopup({message: "অভিনন্দন! ৫ পয়েন্ট যোগ হয়েছে।"}, () => location.reload());
            }).catch(() => tg.showAlert("অ্যাড লোড হয়নি!"));
        }
    }

    function copyRef() {
        const link = `https://t.me/EarnQuick_Official_bot?start=${user.id}`;
        const i = document.createElement('input'); i.value = link;
        document.body.appendChild(i); i.select();
        document.execCommand('copy'); document.body.removeChild(i);
        tg.showAlert("রেফার লিঙ্ক কপি হয়েছে!");
    }

    tg.ready(); tg.expand(); load();
</script>
</body>
</html>
